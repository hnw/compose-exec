name: compose-exec-demo

services:
  controller:
    image: golang:1.25
    volumes:
      - ${DOCKER_SOCKET_PATH:-/var/run/docker.sock}:/var/run/docker.sock
      - .:/app
    working_dir: /app
    command: go run example/main.go

  target:
    image: alpine:latest
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "8080"]
      interval: 1s
      timeout: 1s
      retries: 30
      start_period: 0s
    command: sleep infinity
    profiles:
      - manual
